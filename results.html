<!DOCTYPE html>
<html lang="en">
<head>
    <title>Study Abroad Recommendations - Student DSS</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <div class="d-flex">
        <!-- Sidebar container - will be filled by common.js -->
        <div id="sidebar-container"></div>

        <div class="flex-grow-1">
            <div class="container-fluid py-4">
                <header class="mb-4">
                    <div class="row align-items-center">
                        <div class="col-md-6 mb-3 mb-md-0">
                            <h1>Your Study Abroad Recommendations</h1>
                            <p class="lead">Based on your preferences and criteria weights</p>
                        </div>
                        <div class="col-md-6">
                            <div class="d-flex flex-wrap justify-content-md-end gap-2">
                                <div class="card text-center p-3">
                                    <h3 class="m-0">12</h3>
                                    <p class="small mb-0">Countries Analyzed</p>
                                </div>
                                <div class="card text-center p-3" style="width: 140px;">
                                    <h3 class="m-0">8</h3>
                                    <p class="small mb-0">Criteria Weighted</p>
                                </div>
                                <div class="card text-center p-3" style="width: 140px;">
                                    <h3 class="m-0">95%</h3>
                                    <p class="small mb-0">Match Confidence</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </header>

                <div class="card mb-4">
                    <div class="card-body p-3">
                        <div class="row align-items-center">
                            <div class="col-md-6 mb-3 mb-md-0">
                                <div class="btn-group" role="group">
                                    <button class="btn btn-outline-primary active view-btn" data-view="cards">
                                        <i class="fas fa-th me-1"></i> Cards
                                    </button>
                                    <button class="btn btn-outline-primary view-btn" data-view="table">
                                        <i class="fas fa-table me-1"></i> Table
                                    </button>
                                    <button class="btn btn-outline-primary view-btn" data-view="map">
                                        <i class="fas fa-map-marked-alt me-1"></i> Map
                                    </button>
                                </div>
                                <div class="btn-group ms-2" role="group">
                                    <button class="btn btn-outline-secondary active level-btn" data-level="country">
                                        Countries
                                    </button>
                                    <button class="btn btn-outline-secondary level-btn" data-level="university">
                                        Universities
                                    </button>
                                </div>
                            </div>
                            
                            <div class="col-md-6">
                                <div class="row g-2 align-items-center">
                                    <div class="col-auto">
                                        <select class="form-select" id="regionFilter">
                                            <option value="all">All Regions</option>
                                            <option value="europe">Europe</option>
                                            <option value="north-america">North America</option>
                                            <option value="asia-pacific">Asia Pacific</option>
                                        </select>
                                    </div>
                                    
                                    <div class="col-auto">
                                        <select class="form-select" id="programFilter">
                                            <option value="all">All Programs</option>
                                            <option value="computer_science">Computer Science</option>
                                            <option value="engineering">Engineering</option>
                                            <option value="business">Business</option>
                                            <option value="medicine">Medicine</option>
                                        </select>
                                    </div>
                                    
                                    <div class="col">
                                        <label class="form-label mb-1">Max Budget: $<span id="budgetDisplay">80000</span></label>
                                        <input type="range" class="form-range" id="budgetSlider" min="20000" max="120000" step="5000" value="80000">
                                    </div>
                                    
                                    <div class="col-auto">
                                        <button class="btn btn-primary">
                                            <i class="fas fa-download me-1"></i> Export
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- University Results View (initially hidden) -->
                <div class="row g-4 d-none" id="universityGrid">
                    <!-- University card template -->
                    <div class="col-lg-6 col-xl-4" data-university="uoft">
                        <div class="card h-100">
                            <div class="card-header bg-white">
                                <div class="d-flex justify-content-between align-items-center">
                                    <div class="d-flex align-items-center">
                                        <div class="fs-5 me-2">ðŸ‡¨ðŸ‡¦</div>
                                        <div>
                                            <h3 class="mb-0 fs-5">University of Toronto</h3>
                                            <p class="text-muted mb-0 small">Toronto, Canada</p>
                                        </div>
                                    </div>
                                    <div>
                                        <span class="badge bg-success fs-6">#18</span>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="card-body">
                                <div class="mb-3">
                                    <div class="mb-2">
                                        <div class="d-flex justify-content-between mb-1">
                                            <span class="metric-label">Tuition</span>
                                            <span class="metric-value">$45K/year</span>
                                        </div>
                                        <div class="progress">
                                            <div class="progress-bar" role="progressbar" style="width: 75%" aria-valuenow="75" aria-valuemin="0" aria-valuemax="100"></div>
                                        </div>
                                    </div>
                                    <div class="mb-2">
                                        <div class="d-flex justify-content-between mb-1">
                                            <span class="metric-label">Admission Rate</span>
                                            <span class="metric-value">43%</span>
                                        </div>
                                        <div class="progress">
                                            <div class="progress-bar" role="progressbar" style="width: 43%" aria-valuenow="43" aria-valuemin="0" aria-valuemax="100"></div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="mb-2">
                                    <h6>Popular Programs</h6>
                                    <div class="highlights mb-3">
                                        <span class="badge bg-primary me-1">Computer Science</span>
                                        <span class="badge bg-primary me-1">Engineering</span>
                                        <span class="badge bg-primary me-1">Business</span>
                                        <span class="badge bg-primary">Medicine</span>
                                    </div>
                                </div>
                                
                                <div class="d-flex gap-2">
                                    <button class="btn btn-outline-primary" onclick="addToCompare('uoft', 'university')">
                                        <i class="fas fa-balance-scale me-1"></i> Compare
                                    </button>
                                    <a href="https://www.utoronto.ca" target="_blank" class="btn btn-primary">
                                        <i class="fas fa-external-link-alt me-1"></i> Visit Website
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- More university cards would be dynamically generated -->
                </div>

                <!-- Country Results View -->
                <div class="row g-4" id="resultsGrid">
                    <!-- Country cards (existing code) -->
                    <div class="col-lg-6 col-xl-4" data-country="canada">
                        <div class="card h-100">
                            <div class="card-header bg-white">
                                <div class="d-flex justify-content-between align-items-center">
                                    <div class="d-flex align-items-center">
                                        <div class="fs-3 me-3">ðŸ‡¨ðŸ‡¦</div>
                                        <div>
                                            <h3 class="mb-0 fs-5">Canada</h3>
                                            <p class="text-muted mb-0 small">North America</p>
                                        </div>
                                    </div>
                                    <div>
                                        <span class="badge bg-success fs-6">92%</span>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="card-body">
                                <div class="key-metrics mb-3">
                                    <div class="metric mb-2">
                                        <div class="d-flex justify-content-between mb-1">
                                            <span class="metric-label">Cost</span>
                                            <span class="metric-value">$45K/year</span>
                                        </div>
                                        <div class="progress">
                                            <div class="progress-bar" role="progressbar" style="width: 75%" aria-valuenow="75" aria-valuemin="0" aria-valuemax="100"></div>
                                        </div>
                                    </div>
                                    <div class="metric mb-2">
                                        <div class="d-flex justify-content-between mb-1">
                                            <span class="metric-label">Quality</span>
                                            <span class="metric-value">8.8/10</span>
                                        </div>
                                        <div class="progress">
                                            <div class="progress-bar" role="progressbar" style="width: 88%" aria-valuenow="88" aria-valuemin="0" aria-valuemax="100"></div>
                                        </div>
                                    </div>
                                    <div class="metric">
                                        <div class="d-flex justify-content-between mb-1">
                                            <span class="metric-label">Visa Ease</span>
                                            <span class="metric-value">Moderate</span>
                                        </div>
                                        <div class="progress">
                                            <div class="progress-bar" role="progressbar" style="width: 70%" aria-valuenow="70" aria-valuemin="0" aria-valuemax="100"></div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="highlights mb-3">
                                    <span class="badge bg-success me-1">Strong Job Market</span>
                                    <span class="badge bg-success me-1">High QoL</span>
                                    <span class="badge bg-info">Moderate Cost</span>
                                </div>
                                
                                <div class="d-flex gap-2">
                                    <button class="btn btn-outline-primary" onclick="addToCompare('canada')">
                                        <i class="fas fa-balance-scale me-1"></i> Add to Compare
                                    </button>
                                    <button class="btn btn-primary" onclick="viewDetails('canada')">
                                        <i class="fas fa-info-circle me-1"></i> View Details
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Germany Card -->
                    <div class="col-lg-6 col-xl-4" data-country="germany">
                        <div class="card h-100">
                            <div class="card-header bg-white">
                                <div class="d-flex justify-content-between align-items-center">
                                    <div class="d-flex align-items-center">
                                        <div class="fs-3 me-3">ðŸ‡©ðŸ‡ª</div>
                                        <div>
                                            <h3 class="mb-0 fs-5">Germany</h3>
                                            <p class="text-muted mb-0 small">Europe</p>
                                        </div>
                                    </div>
                                    <div>
                                        <span class="badge bg-success fs-6">89%</span>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="card-body">
                                <div class="key-metrics mb-3">
                                    <div class="metric mb-2">
                                        <div class="d-flex justify-content-between mb-1">
                                            <span class="metric-label">Cost</span>
                                            <span class="metric-value">$25K/year</span>
                                        </div>
                                        <div class="progress">
                                            <div class="progress-bar" role="progressbar" style="width: 85%" aria-valuenow="85" aria-valuemin="0" aria-valuemax="100"></div>
                                        </div>
                                    </div>
                                    <div class="metric mb-2">
                                        <div class="d-flex justify-content-between mb-1">
                                            <span class="metric-label">Quality</span>
                                            <span class="metric-value">8.5/10</span>
                                        </div>
                                        <div class="progress">
                                            <div class="progress-bar" role="progressbar" style="width: 85%" aria-valuenow="85" aria-valuemin="0" aria-valuemax="100"></div>
                                        </div>
                                    </div>
                                    <div class="metric">
                                        <div class="d-flex justify-content-between mb-1">
                                            <span class="metric-label">Visa Ease</span>
                                            <span class="metric-value">Easy</span>
                                        </div>
                                        <div class="progress">
                                            <div class="progress-bar" role="progressbar" style="width: 90%" aria-valuenow="90" aria-valuemin="0" aria-valuemax="100"></div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="highlights mb-3">
                                    <span class="badge bg-success me-1">Low Cost</span>
                                    <span class="badge bg-success me-1">Strong Engineering</span>
                                    <span class="badge bg-info">EU Access</span>
                                </div>
                                
                                <div class="d-flex gap-2">
                                    <button class="btn btn-outline-primary" onclick="addToCompare('germany')">
                                        <i class="fas fa-balance-scale me-1"></i> Add to Compare
                                    </button>
                                    <button class="btn btn-primary" onclick="viewDetails('germany')">
                                        <i class="fas fa-info-circle me-1"></i> View Details
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Results Table View -->
                <div class="card d-none" id="resultsTable">
                    <div class="card-body">
                        <table class="table table-hover">
                            <thead>
                                <tr>
                                    <th>Rank</th>
                                    <th>Country</th>
                                    <th>Overall Score</th>
                                    <th>Cost Score</th>
                                    <th>Quality Score</th>
                                    <th>Safety Score</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="tableBody">
                                <tr>
                                    <td>1</td>
                                    <td><span class="country-flag me-2">ðŸ‡¨ðŸ‡¦</span> Canada</td>
                                    <td><strong class="text-success">92%</strong></td>
                                    <td>75%</td>
                                    <td>88%</td>
                                    <td>90%</td>
                                    <td>
                                        <button class="btn btn-sm btn-outline-primary" onclick="addToCompare('canada')">
                                            <i class="fas fa-balance-scale"></i>
                                        </button>
                                        <button class="btn btn-sm btn-primary" onclick="viewDetails('canada')">
                                            <i class="fas fa-info-circle"></i>
                                        </button>
                                    </td>
                                </tr>
                                <tr>
                                    <td>2</td>
                                    <td><span class="country-flag me-2">ðŸ‡©ðŸ‡ª</span> Germany</td>
                                    <td><strong class="text-success">89%</strong></td>
                                    <td>85%</td>
                                    <td>85%</td>
                                    <td>87%</td>
                                    <td>
                                        <button class="btn btn-sm btn-outline-primary" onclick="addToCompare('germany')">
                                            <i class="fas fa-balance-scale"></i>
                                        </button>
                                        <button class="btn btn-sm btn-primary" onclick="viewDetails('germany')">
                                            <i class="fas fa-info-circle"></i>
                                        </button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <div class="card d-none" id="universityTable">
                    <div class="card-body">
                        <table class="table table-hover">
                            <thead>
                                <tr>
                                    <th>Rank</th>
                                    <th>University</th>
                                    <th>Location</th>
                                    <th>Annual Cost</th>
                                    <th>Admission Rate</th>
                                    <th>Programs</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="universityTableBody">
                                <tr>
                                    <td>#18</td>
                                    <td>University of Toronto</td>
                                    <td><span class="country-flag me-2">ðŸ‡¨ðŸ‡¦</span> Toronto, Canada</td>
                                    <td>$65,000</td>
                                    <td>43%</td>
                                    <td>
                                        <span class="badge bg-primary">CS</span>
                                        <span class="badge bg-primary">Eng</span>
                                    </td>
                                    <td>
                                        <button class="btn btn-sm btn-outline-primary" onclick="addToCompare('uoft', 'university')">
                                            <i class="fas fa-balance-scale"></i>
                                        </button>
                                        <a href="https://www.utoronto.ca" target="_blank" class="btn btn-sm btn-primary">
                                            <i class="fas fa-external-link-alt"></i>
                                        </a>
                                    </td>
                                </tr>
                                <!-- More university rows would be dynamically generated -->
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <!-- Map View (existing code) -->
                <div class="card d-none" id="resultsMap">
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-9">
                                <div id="worldMap" class="bg-light rounded p-3 d-flex align-items-center justify-content-center" style="height: 500px;">
                                    <p class="text-muted">Interactive world map will be displayed here</p>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="map-legend">
                                    <h4>Score Range</h4>
                                    <div class="d-flex align-items-center mb-2">
                                        <span class="bg-success me-2 rounded" style="width: 20px; height: 20px; display: inline-block;"></span>
                                        <span>90-100% Match</span>
                                    </div>
                                    <div class="d-flex align-items-center mb-2">
                                        <span class="legend-color medium me-2" style="width: 20px; height: 20px; display: inline-block; background-color: #0d6efd; border-radius: 4px;"></span>
                                        <span>70-89% Match</span>
                                    </div>
                                    <div class="d-flex align-items-center">
                                        <span class="legend-color low me-2" style="width: 20px; height: 20px; display: inline-block; background-color: #6c757d; border-radius: 4px;"></span>
                                        <span>Below 70% Match</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap 5 JS Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/js/all.min.js" defer></script>
    <script src="js/auth.js"></script>
    <script src="js/common.js"></script>
    <script src="js/data.js"></script>
    <script>
        // Authentication code
        document.addEventListener('DOMContentLoaded', function() {
            // Check if user is logged in
            if (typeof checkLoginStatus === 'function') {
                const { isLoggedIn, userRole } = checkLoginStatus();
                
                if (isLoggedIn !== 'true') {
                    // If not logged in, redirect to login page
                    window.location.href = 'login.html';
                    return;
                }
                
                // Update username in sidebar
                const username = localStorage.getItem('username');
                const sidebarUsernameElement = document.getElementById('sidebarUsername');
                const sidebarUserRoleElement = document.getElementById('sidebarUserRole');
                
                if (sidebarUsernameElement) {
                    sidebarUsernameElement.textContent = username || 'Guest';
                }
                
                if (sidebarUserRoleElement) {
                    sidebarUserRoleElement.textContent = userRole === 'admin' ? 'Administrator' : 'Student';
                }
                
                // Handle sidebar logout button
                const sidebarLogoutBtn = document.getElementById('sidebarLogout');
                if (sidebarLogoutBtn) {
                    sidebarLogoutBtn.addEventListener('click', function(e) {
                        e.preventDefault();
                        
                        // Clear login status
                        localStorage.removeItem('isLoggedIn');
                        localStorage.removeItem('userRole');
                        localStorage.removeItem('username');
                        
                        // Redirect to login page
                        window.location.href = 'login.html';
                    });
                }
            }

            // View switching functionality
            document.querySelectorAll('.view-btn').forEach(button => {
                button.addEventListener('click', function() {
                    // Update active button
                    document.querySelectorAll('.view-btn').forEach(btn => {
                        btn.classList.remove('active');
                    });
                    this.classList.add('active');
                    
                    // Get the view type
                    const viewType = this.getAttribute('data-view');
                    const currentLevel = document.querySelector('.level-btn.active').getAttribute('data-level');
                    
                    // Hide all views
                    document.getElementById('resultsGrid').classList.add('d-none');
                    document.getElementById('universityGrid').classList.add('d-none');
                    document.getElementById('resultsTable').classList.add('d-none');
                    document.getElementById('universityTable').classList.add('d-none');
                    document.getElementById('resultsMap').classList.add('d-none');
                    
                    // Show selected view based on level
                    if (currentLevel === 'country') {
                        if (viewType === 'cards') {
                            document.getElementById('resultsGrid').classList.remove('d-none');
                        } else if (viewType === 'table') {
                            document.getElementById('resultsTable').classList.remove('d-none');
                        } else if (viewType === 'map') {
                            document.getElementById('resultsMap').classList.remove('d-none');
                        }
                    } else {
                        if (viewType === 'cards') {
                            document.getElementById('universityGrid').classList.remove('d-none');
                        } else if (viewType === 'table') {
                            document.getElementById('universityTable').classList.remove('d-none');
                        } else if (viewType === 'map') {
                            document.getElementById('resultsMap').classList.remove('d-none');
                        }
                    }
                });
            });

            // Level switching functionality
            document.querySelectorAll('.level-btn').forEach(button => {
                button.addEventListener('click', function() {
                    // Update active button
                    document.querySelectorAll('.level-btn').forEach(btn => {
                        btn.classList.remove('active');
                    });
                    this.classList.add('active');
                    
                    // Get the level type and current view
                    const levelType = this.getAttribute('data-level');
                    const currentView = document.querySelector('.view-btn.active').getAttribute('data-view');
                    
                    // Hide all views
                    document.getElementById('resultsGrid').classList.add('d-none');
                    document.getElementById('universityGrid').classList.add('d-none');
                    document.getElementById('resultsTable').classList.add('d-none');
                    document.getElementById('universityTable').classList.add('d-none');
                    document.getElementById('resultsMap').classList.add('d-none');
                    
                    // Show selected view based on level
                    if (levelType === 'country') {
                        if (currentView === 'cards') {
                            document.getElementById('resultsGrid').classList.remove('d-none');
                        } else if (currentView === 'table') {
                            document.getElementById('resultsTable').classList.remove('d-none');
                        } else if (currentView === 'map') {
                            document.getElementById('resultsMap').classList.remove('d-none');
                        }
                    } else {
                        if (currentView === 'cards') {
                            document.getElementById('universityGrid').classList.remove('d-none');
                        } else if (currentView === 'table') {
                            document.getElementById('universityTable').classList.remove('d-none');
                        } else if (currentView === 'map') {
                            document.getElementById('resultsMap').classList.remove('d-none');
                        }
                    }
                    
                    // Populate university data if needed
                    if (levelType === 'university' && !document.getElementById('universityGrid').hasAttribute('data-loaded')) {
                        loadUniversityData();
                    }
                });
            });

            // Budget slider
            const budgetSlider = document.getElementById('budgetSlider');
            const budgetDisplay = document.getElementById('budgetDisplay');
            
            if (budgetSlider && budgetDisplay) {
                budgetSlider.addEventListener('input', function() {
                    budgetDisplay.textContent = this.value;
                });
            }

            // Load universities data
            function loadUniversityData() {
                // Mark as loaded so we don't reload
                document.getElementById('universityGrid').setAttribute('data-loaded', 'true');
                
                const universityGrid = document.getElementById('universityGrid');
                const universityTableBody = document.getElementById('universityTableBody');
                
                // Clear existing content
                universityGrid.innerHTML = '';
                universityTableBody.innerHTML = '';
                
                // Load data from our data.js file
                universitiesData.forEach((university, index) => {
                    // Get country data
                    const country = countriesData[university.country];
                    
                    // Create card for university
                    const card = document.createElement('div');
                    card.className = 'col-lg-6 col-xl-4';
                    card.dataset.university = university.id;
                    card.dataset.country = university.country;
                    
                    card.innerHTML = `
                        <div class="card h-100">
                            <div class="card-header bg-white">
                                <div class="d-flex justify-content-between align-items-center">
                                    <div class="d-flex align-items-center">
                                        <div class="fs-5 me-2">${country.flag}</div>
                                        <div>
                                            <h3 class="mb-0 fs-5">${university.name}</h3>
                                            <p class="text-muted mb-0 small">${university.city}, ${country.name}</p>
                                        </div>
                                    </div>
                                    <div>
                                        <span class="badge bg-success fs-6">#${university.ranking}</span>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="card-body">
                                <div class="mb-3">
                                    <div class="mb-2">
                                        <div class="d-flex justify-content-between mb-1">
                                            <span class="metric-label">Total Cost</span>
                                            <span class="metric-value">$${(university.tuition + university.living).toLocaleString()}/year</span>
                                        </div>
                                        <div class="progress">
                                            <div class="progress-bar" role="progressbar" style="width: ${Math.min(100, ((university.tuition + university.living)/80000)*100)}%" 
                                                aria-valuenow="${Math.min(100, ((university.tuition + university.living)/80000)*100)}" aria-valuemin="0" aria-valuemax="100"></div>
                                        </div>
                                    </div>
                                    <div class="mb-2">
                                        <div class="d-flex justify-content-between mb-1">
                                            <span class="metric-label">Admission Rate</span>
                                            <span class="metric-value">${university.admissionRate}%</span>
                                        </div>
                                        <div class="progress">
                                            <div class="progress-bar" role="progressbar" style="width: ${university.admissionRate}%" 
                                                aria-valuenow="${university.admissionRate}" aria-valuemin="0" aria-valuemax="100"></div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="mb-2">
                                    <h6>Popular Programs</h6>
                                    <div class="highlights mb-3">
                                        ${university.programs.map(program => `<span class="badge bg-primary me-1">${program}</span>`).join('')}
                                    </div>
                                </div>
                                
                                <div class="d-flex gap-2">
                                    <button class="btn btn-outline-primary" onclick="addToCompare('${university.id}', 'university')">
                                        <i class="fas fa-balance-scale me-1"></i> Compare
                                    </button>
                                    <a href="${university.website}" target="_blank" class="btn btn-primary">
                                        <i class="fas fa-external-link-alt me-1"></i> Visit Website
                                    </a>
                                </div>
                            </div>
                        </div>
                    `;
                    
                    universityGrid.appendChild(card);
                    
                    // Create row for university table
                    const row = document.createElement('tr');
                    row.dataset.university = university.id;
                    row.dataset.country = university.country;
                    
                    row.innerHTML = `
                        <td>#${university.ranking}</td>
                        <td>${university.name}</td>
                        <td><span class="country-flag me-2">${country.flag}</span> ${university.city}, ${country.name}</td>
                        <td>$${(university.tuition + university.living).toLocaleString()}</td>
                        <td>${university.admissionRate}%</td>
                        <td>
                            ${university.programs.slice(0, 3).map(program => `<span class="badge bg-primary me-1">${program.substring(0, 3)}</span>`).join('')}
                        </td>
                        <td>
                            <button class="btn btn-sm btn-outline-primary" onclick="addToCompare('${university.id}', 'university')">
                                <i class="fas fa-balance-scale"></i>
                            </button>
                            <a href="${university.website}" target="_blank" class="btn btn-sm btn-primary">
                                <i class="fas fa-external-link-alt"></i>
                            </a>
                        </td>
                    `;
                    
                    universityTableBody.appendChild(row);
                });
            }
        });

        // Updated to handle university comparison as well
        function addToCompare(id, type = 'country') {
            if (type === 'country') {
                alert(`Added ${id} to comparison list`);
            } else {
                alert(`Added university ${id} to comparison list`);
            }
            // Implementation will be added later
        }

        function viewDetails(id, type = 'country') {
            if (type === 'country') {
                alert(`Viewing details for ${id}`);
            } else {
                alert(`Viewing details for university ${id}`);
            }
            // Implementation will be added later
        }
    </script>
    <script src="js/results.js"></script>
</body>
</html>
